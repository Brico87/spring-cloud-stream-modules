<?xml version="1.0" encoding="UTF-8" standalone="no"?><!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops" xmlns:m="http://www.w3.org/1998/Math/MathML" xmlns:pls="http://www.w3.org/2005/01/pronunciation-lexicon" xmlns:ssml="http://www.w3.org/2001/10/synthesis" xmlns:svg="http://www.w3.org/2000/svg"><head><title>Field Value Counter (field-value-counter)</title><link rel="stylesheet" type="text/css" href="docbook-epub.css"/><meta name="generator" content="DocBook XSL Stylesheets V1.78.1"/><link rel="prev" href="ch04s02.xhtml" title="Counter (counter)"/><link rel="next" href="ch04s04.xhtml" title="File (file)"/></head><body><header/><section class="section" title="Field Value Counter (field-value-counter)" epub:type="subchapter" id="spring-cloud-stream-modules-field-value-counter"><div class="titlepage"><div><div><h2 class="title" style="clear: both">Field Value Counter (<code class="literal">field-value-counter</code>)</h2></div></div></div><p>A field value counter is a Metric used for counting occurrences of unique values for a named field in a message payload. Spring Cloud Data Flow supports the following payload types out of the box:</p><div class="itemizedlist" epub:type="list"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem" epub:type="list-item">POJO (Java bean)</li><li class="listitem" epub:type="list-item">Tuple</li><li class="listitem" epub:type="list-item">JSON String</li></ul></div><p>For example suppose a message source produces a payload with a field named <span class="emphasis"><em>user</em></span> :</p><pre class="programlisting">class Foo {
   String user;
   public Foo(String user) {
       this.user = user;
   }
}</pre><p>If the stream source produces messages with the following objects:</p><pre class="programlisting">   new Foo("fred")
   new Foo("sue")
   new Foo("dave")
   new Foo("sue")</pre><p>The field value counter on the field <span class="emphasis"><em>user</em></span> will contain:</p><pre class="literallayout">fred:1, sue:2, dave:1</pre><p>Multi-value fields are also supported. For example, if a field contains a list, each value will be counted once:</p><pre class="literallayout">users:["dave","fred","sue"]
users:["sue","jon"]</pre><p>The field value counter on the field <span class="emphasis"><em>users</em></span> will contain:</p><pre class="literallayout">dave:1, fred:1, sue:2, jon:1</pre><section class="section" title="Options" epub:type="division" id="_options_18"><div class="titlepage"><div><div><h3 class="title">Options</h3></div></div></div><p>The <span class="strong"><strong>field-value-counter</strong></span> sink has the following options:</p><div class="variablelist" epub:type="list"><dl class="variablelist"><dt><span class="term">fieldName</span></dt><dd>the name of the field for which values are counted <span class="strong"><strong>(String, no default)</strong></span></dd><dt><span class="term">name</span></dt><dd>the name of the metric to contribute to (will be created if necessary) <span class="strong"><strong>(String, default: <code class="literal">&lt;stream name&gt;</code>)</strong></span></dd><dt><span class="term">nameExpression</span></dt><dd>a SpEL expression to compute the name of the metric to contribute to <span class="strong"><strong>(String, no default)</strong></span></dd></dl></div></section></section><footer/></body></html>